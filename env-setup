
if [ ! -d ".status" ]; then
	mkdir .status 
fi

./setup/install-dependencies
./setup/install-npm
./setup/install-pyjs

# Install GnuCOBOL
ldconfig /usr/local/lib

./setup/install-jsil
./setup/install-dragome
./setup/install-emscripten
./setup/install-gcc
./setup/install-llvm
./setup/install-dragonegg
./setup/install-ghcjs

if [ ! -f ".status/find-main" ]; then
	git clone https://github.com/duffslaves/main-finder.git
	
	cd main-finder
	mvn package
	cd ../
	
	echo > .status/find-main
fi

if [ ! -f ".status/chicken" ]; then
	apt-get install -y chicken
	
	echo > .status/chicken
fi

if [ ! -f ".status/opal" ]; then
	gem install opal
	
	echo > .status/opal
fi

# Add our commands to shell environment
# This will require a restart to take effect
echo export PATH=\$PATH:$PWD/commands > /etc/profile.d/moodle-code-window.sh
chmod a+x /etc/profile.d/moodle-code-window.sh

